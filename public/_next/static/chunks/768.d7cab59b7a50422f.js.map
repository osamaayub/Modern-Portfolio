{"version":3,"file":"static/chunks/768.d7cab59b7a50422f.js","mappings":"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","sources":["webpack://_N_E/./components/ui/Globe.tsx"],"sourcesContent":["/* eslint-disable react-hooks/exhaustive-deps */\n'use client';\nimport { useEffect, useRef, useState } from 'react';\nimport { Color, Scene, Fog, PerspectiveCamera, Vector3 } from 'three';\nimport ThreeGlobe from 'three-globe';\nimport { useThree, Object3DNode, Canvas, extend } from '@react-three/fiber';\nimport { OrbitControls } from '@react-three/drei';\nimport countries from '@/data/globe.json';\ndeclare module '@react-three/fiber' {\n  interface ThreeElements {\n    threeGlobe: Object3DNode<ThreeGlobe, typeof ThreeGlobe>;\n  }\n}\n\nextend({ ThreeGlobe });\n\nconst RING_PROPAGATION_SPEED = 3;\nconst aspect = 1.2;\nconst cameraZ = 300;\n\ntype Position = {\n  order: number;\n  startLat: number;\n  startLng: number;\n  endLat: number;\n  endLng: number;\n  arcAlt: number;\n  color: string;\n};\n\nexport type GlobeConfig = {\n  pointSize?: number;\n  globeColor?: string;\n  showAtmosphere?: boolean;\n  atmosphereColor?: string;\n  atmosphereAltitude?: number;\n  emissive?: string;\n  emissiveIntensity?: number;\n  shininess?: number;\n  polygonColor?: string;\n  ambientLight?: string;\n  directionalLeftLight?: string;\n  directionalTopLight?: string;\n  pointLight?: string;\n  arcTime?: number;\n  arcLength?: number;\n  rings?: number;\n  maxRings?: number;\n  initialPosition?: {\n    lat: number;\n    lng: number;\n  };\n  autoRotate?: boolean;\n  autoRotateSpeed?: number;\n};\n\ninterface WorldProps {\n  globeConfig: GlobeConfig;\n  data: Position[];\n}\n\nlet numbersOfRings = [0];\n\nexport function Globe({ globeConfig, data }: WorldProps) {\n  const [globeData, setGlobeData] = useState<\n    | {\n        size: number;\n        order: number;\n        color: (t: number) => string;\n        lat: number;\n        lng: number;\n      }[]\n    | null\n  >(null);\n\n  const globeRef = useRef<ThreeGlobe | null>(null);\n\n  const defaultProps = {\n    pointSize: 1,\n    atmosphereColor: '#ffffff',\n    showAtmosphere: true,\n    atmosphereAltitude: 0.1,\n    polygonColor: 'rgba(255,255,255,0.7)',\n    globeColor: '#1d072e',\n    emissive: '#000000',\n    emissiveIntensity: 0.1,\n    shininess: 0.9,\n    arcTime: 2000,\n    arcLength: 0.9,\n    rings: 1,\n    maxRings: 3,\n    ...globeConfig,\n  };\n\n  useEffect(() => {\n    if (globeRef.current) {\n      _buildData();\n      _buildMaterial();\n    }\n  }, [globeRef.current]);\n\n  const _buildMaterial = () => {\n    if (!globeRef.current) return;\n\n    const globeMaterial = globeRef.current.globeMaterial() as unknown as {\n      color: Color;\n      emissive: Color;\n      emissiveIntensity: number;\n      shininess: number;\n    };\n    globeMaterial.color = new Color(globeConfig.globeColor);\n    globeMaterial.emissive = new Color(globeConfig.emissive);\n    globeMaterial.emissiveIntensity = globeConfig.emissiveIntensity || 0.1;\n    globeMaterial.shininess = globeConfig.shininess || 0.9;\n  };\n\n  const _buildData = () => {\n    const arcs = data;\n    let points = [];\n    for (let i = 0; i < arcs.length; i++) {\n      const arc = arcs[i];\n      const rgb = hexToRgb(arc.color) as { r: number; g: number; b: number };\n      points.push({\n        size: defaultProps.pointSize,\n        order: arc.order,\n        color: (t: number) => `rgba(${rgb.r}, ${rgb.g}, ${rgb.b}, ${1 - t})`,\n        lat: arc.startLat,\n        lng: arc.startLng,\n      });\n      points.push({\n        size: defaultProps.pointSize,\n        order: arc.order,\n        color: (t: number) => `rgba(${rgb.r}, ${rgb.g}, ${rgb.b}, ${1 - t})`,\n        lat: arc.endLat,\n        lng: arc.endLng,\n      });\n    }\n\n    // remove duplicates for same lat and lng\n    const filteredPoints = points.filter(\n      (v, i, a) =>\n        a.findIndex((v2) =>\n          ['lat', 'lng'].every(\n            (k) => v2[k as 'lat' | 'lng'] === v[k as 'lat' | 'lng']\n          )\n        ) === i\n    );\n\n    setGlobeData(filteredPoints);\n  };\n\n  useEffect(() => {\n    if (globeRef.current && globeData) {\n      globeRef.current\n        .hexPolygonsData(countries.features)\n        .hexPolygonResolution(3)\n        .hexPolygonMargin(0.7)\n        .showAtmosphere(defaultProps.showAtmosphere)\n        .atmosphereColor(defaultProps.atmosphereColor)\n        .atmosphereAltitude(defaultProps.atmosphereAltitude)\n        .hexPolygonColor((e) => {\n          return defaultProps.polygonColor;\n        });\n      startAnimation();\n    }\n  }, [globeData]);\n\n  const startAnimation = () => {\n    if (!globeRef.current || !globeData) return;\n\n    globeRef.current\n      .arcsData(data)\n      .arcStartLat((d) => (d as { startLat: number }).startLat * 1)\n      .arcStartLng((d) => (d as { startLng: number }).startLng * 1)\n      .arcEndLat((d) => (d as { endLat: number }).endLat * 1)\n      .arcEndLng((d) => (d as { endLng: number }).endLng * 1)\n      .arcColor((e: any) => (e as { color: string }).color)\n      .arcAltitude((e) => {\n        return (e as { arcAlt: number }).arcAlt * 1;\n      })\n      .arcStroke((e) => {\n        return [0.32, 0.28, 0.3][Math.round(Math.random() * 2)];\n      })\n      .arcDashLength(defaultProps.arcLength)\n      .arcDashInitialGap((e) => (e as { order: number }).order * 1)\n      .arcDashGap(15)\n      .arcDashAnimateTime((e) => defaultProps.arcTime);\n\n    globeRef.current\n      .pointsData(data)\n      .pointColor((e) => (e as { color: string }).color)\n      .pointsMerge(true)\n      .pointAltitude(0.0)\n      .pointRadius(2);\n\n    globeRef.current\n      .ringsData([])\n      .ringColor((e: any) => (t: any) => e.color(t))\n      .ringMaxRadius(defaultProps.maxRings)\n      .ringPropagationSpeed(RING_PROPAGATION_SPEED)\n      .ringRepeatPeriod(\n        (defaultProps.arcTime * defaultProps.arcLength) / defaultProps.rings\n      );\n  };\n\n  useEffect(() => {\n    if (!globeRef.current || !globeData) return;\n\n    const interval = setInterval(() => {\n      if (!globeRef.current || !globeData) return;\n      numbersOfRings = genRandomNumbers(\n        0,\n        data.length,\n        Math.floor((data.length * 4) / 5)\n      );\n\n      globeRef.current.ringsData(\n        globeData.filter((d, i) => numbersOfRings.includes(i))\n      );\n    }, 2000);\n\n    return () => {\n      clearInterval(interval);\n    };\n  }, [globeRef.current, globeData]);\n\n  return (\n    <>\n      <threeGlobe ref={globeRef} />\n    </>\n  );\n}\n\nexport function WebGLRendererConfig() {\n  const { gl, size } = useThree();\n\n  useEffect(() => {\n    gl.setPixelRatio(window.devicePixelRatio);\n    gl.setSize(size.width, size.height);\n    gl.setClearColor(0xffaaff, 0);\n  }, []);\n\n  return null;\n}\n\nexport function World(props: WorldProps) {\n  const { globeConfig } = props;\n  const scene = new Scene();\n  scene.fog = new Fog(0xffffff, 400, 2000);\n  return (\n    <Canvas scene={scene} camera={new PerspectiveCamera(50, aspect, 180, 1800)}>\n      <WebGLRendererConfig />\n      <ambientLight color={globeConfig.ambientLight} intensity={0.6} />\n      <directionalLight\n        color={globeConfig.directionalLeftLight}\n        position={new Vector3(-400, 100, 400)}\n      />\n      <directionalLight\n        color={globeConfig.directionalTopLight}\n        position={new Vector3(-200, 500, 200)}\n      />\n      <pointLight\n        color={globeConfig.pointLight}\n        position={new Vector3(-200, 500, 200)}\n        intensity={0.8}\n      />\n      <Globe {...props} />\n      <OrbitControls\n        enablePan={false}\n        enableZoom={false}\n        minDistance={cameraZ}\n        maxDistance={cameraZ}\n        autoRotateSpeed={1}\n        autoRotate={true}\n        minPolarAngle={Math.PI / 3.5}\n        maxPolarAngle={Math.PI - Math.PI / 3}\n      />\n    </Canvas>\n  );\n}\n\nexport function hexToRgb(hex: string) {\n  var shorthandRegex = /^#?([a-f\\d])([a-f\\d])([a-f\\d])$/i;\n  hex = hex.replace(shorthandRegex, function (m, r, g, b) {\n    return r + r + g + g + b + b;\n  });\n\n  var result = /^#?([a-f\\d]{2})([a-f\\d]{2})([a-f\\d]{2})$/i.exec(hex);\n  return result\n    ? {\n        r: parseInt(result[1], 16),\n        g: parseInt(result[2], 16),\n        b: parseInt(result[3], 16),\n      }\n    : null;\n}\n\nexport function genRandomNumbers(min: number, max: number, count: number) {\n  const arr = [];\n  while (arr.length < count) {\n    const r = Math.floor(Math.random() * (max - min)) + min;\n    if (arr.indexOf(r) === -1) arr.push(r);\n  }\n\n  return arr;\n}\n"],"names":["extend","ThreeGlobe","numbersOfRings","Globe","param","globeConfig","data","globeData","setGlobeData","useState","globeRef","useRef","defaultProps","pointSize","atmosphereColor","showAtmosphere","atmosphereAltitude","polygonColor","globeColor","emissive","emissiveIntensity","shininess","arcTime","arcLength","rings","maxRings","useEffect","current","_buildData","_buildMaterial","globeMaterial","color","Color","points","i","arcs","length","arc","rgb","hexToRgb","push","size","order","r","g","concat","b","t","lat","startLat","lng","startLng","endLat","endLng","filter","v","a","findIndex","every","v2","k","hexPolygonsData","countries","hexPolygonResolution","hexPolygonMargin","hexPolygonColor","startAnimation","arcsData","arcStartLat","d","arcStartLng","arcEndLat","arcEndLng","arcColor","e","arcAltitude","arcAlt","arcStroke","Math","round","random","arcDashLength","arcDashInitialGap","arcDashGap","arcDashAnimateTime","pointsData","pointColor","pointsMerge","pointAltitude","pointRadius","ringsData","ringColor","ringMaxRadius","ringPropagationSpeed","ringRepeatPeriod","interval","setInterval","genRandomNumbers","floor","includes","clearInterval","jsx_runtime","jsx","Fragment","threeGlobe","ref","WebGLRendererConfig","gl","useThree","setPixelRatio","window","devicePixelRatio","setSize","width","height","setClearColor","World","props","scene","Scene","fog","Fog","jsxs","Canvas","camera","PerspectiveCamera","ambientLight","intensity","directionalLight","directionalLeftLight","position","Vector3","directionalTopLight","pointLight","OrbitControls","enablePan","enableZoom","minDistance","maxDistance","autoRotateSpeed","autoRotate","minPolarAngle","PI","maxPolarAngle","hex","replace","m","result","exec","parseInt","min","max","count","arr","indexOf"],"sourceRoot":""}